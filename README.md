# Welcome to Market API!



This is an API written in Java and Spring Boot that allows you to interact with operations to manage a market.

*This is a project based on [platzi's Java Spring course](https://platzi.com/cursos/java-spring/ "platzi's Java Spring course")*

To develop this API we used the following modules:

- Spring Boot
- Spring Security
- Spring Web
- Spring Data JPA
- Swagger
- PostgreSQL
- JSON Web Tokens (JWT)

The marketplace API was built under Domain Driven Design (DDD).

# Database

Market API uses postgreSQL as the database engine.
Below is the entity relationship diagram of the application.

![image](https://user-images.githubusercontent.com/57375735/224459295-4aa8d0c1-0d65-4cb2-b043-7cb8b345ce4e.png)

In the resources folder you can find a sql script called "schema.sql" to create the tables in the database.

# How to run

1. Create a database in PostgreSQL and execute the SQL script named 'schema.sql' located in the resources folder to create the database tables.
2. Open the project with Intellij IDEA or another IDE.
3. Modify application-dev.properties to change the connection string to postresql
4. Run the application in your development environment or compile the .jar file and run it on your application server.

You can see the documentation of the API generated by swagger in the path: http://localhost:8090/market/api/swagger-ui/index.html

# Authentication

Market API uses Oauth 2.0 for the authentication process through JWT.

Before you start, you need to register a user in the database.

Insert a user into the users table making sure that the password is encrypted with BCryptPasswordEncoder.

Here is an example:

Password: darwin 
Password crypted by BCryptPasswordEncoder: $2a$10$ARAAfY1OwuUgYx2dsMpXuO8nBwAl4D67JeMiIyFFLpyS1YX8A4dyy

```sql
INSERT INTO users VALUES ("admin", "$2a$10$ARAAfY1OwuUgYx2dsMpXuO8nBwAl4D67JeMiIyFFLpyS1YX8A4dyy")
```

## Get a JWT

Make a "POST" to `/market/api/login` endpoint with the username and password in the body of the request.

```
{
    "username": "admin",
    "password": "darwin"
}
```


If the authentication process is successful, you can find in the response headers a header with a bearer token to authenticate the next requests.

![image](https://user-images.githubusercontent.com/57375735/224460547-5ea91871-0a90-4d94-b6cf-b71acd041454.png)
